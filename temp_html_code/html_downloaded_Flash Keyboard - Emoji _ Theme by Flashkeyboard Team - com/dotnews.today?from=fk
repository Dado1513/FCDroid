<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="fb:pages" content="1525816104123249"/>
<link rel="icon" href="images/favicon.png" type="image/x-icon"/>
<link rel="stylesheet" href="css/dotNews_style.css?v=20170119">
<script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="js/jquery.lazyload.min.js"></script>
<script type="text/javascript" src="js/public.js?v=20170511"></script>
<title>DotNews:Top News.Videos.GIFs.Photos</title>
<meta name="keywords" content="DotNews, breaking news, U.S. news, world news, CNN News, AOL News, Fox News, NYTimes, The Wall Street Journal, weather, business, money, politics, technology, entertainment, education, travel, health">
<meta name="description" content="Find the latest stories and breaking news on sports, weather, business, entertainment, politics, health, technology, auto, education, pop culture, and more. Read from world class publications like CNN News, AOL News, NYTimes, The Huffington Post, Fox News, The Washington Post, USA Today, CNET, Business Insider, Forbes, Bloomberg, NBC News, and The Wall Street Journal.">
</head>
  
<body>
	<div id="calContainer">
    <div class="dot_top">
            <div class="dot_dload">
                <div class="dload_l"><img src="images/dot_news_icon.png?v=20170119" class="dload_icon"> <p class="dload_h2">Dot News</p> <p class="dload_h3">News tailored to you</p></div>
                <div class="dload_r" id="openApp"><img src="images/Open_App.png"></div>
                <div class="cls"></div>
                <div class="dload_clo"><img src="images/close_2x.png"> </div>
            </div>
            <!--<div class="dot_logo"><img src="/images/logo.png"> </div>-->
        </div>
	<div class="page">
    <div class="header">
        
        <div class="menu">
            <div class="menu_list">
                <!--<a href="#">For You</a>-->
            </div>
            <span class="menu_btn"></span>
        </div>
        <div class="cls"></div>
    </div>
    <div class="content content_home">
        <div class="newslist" id="homeNewsList">
            <!--<ul>
                <li class="newslist_img"><a href="#"><img src="/images/1-1.jpg"> </a> </li>
                <li class="newslist_txt"><a href="#" class="newslist_title">Emma Watson Masters Easy With Evening Polish With One Simple</a> <p><span class="newslist_source">India Today</span><span class="newslist_time">32Mins ago</span></p></li>
                <div class="cls"></div>
            </ul>-->
        </div>
        <div class="newslist_load"><span class="loading1"></span>loading...</div>
    </div>
</div>
</div>

<script type="text/javascript">  
    var g_seq_id = 0,g_rec_time = 0;
    window.categories = 0;
    window.newslist = [];    
	$(document).ready(function(){
        $.ajax({
            url: url + "categories/sorted/",
            type:"get",
            dataType:"json",
            success: function(data){
                var menuHtmls = "";
                for(var i =0;i<data.length;i++){
                    if(data[i].name !='funny' && data[i].name !='pets'){
                        window.newslist.push(data[i]);
                    }                    
                }
                for(var i=0;i<window.newslist.length;i++){
                    menuHtmls += '<a class ="" href="javascript:" data-name="'+ window.newslist[i].name +'">'+ window.newslist[i].title +'</a>';
                }
                $(".menu_list").html(menuHtmls);
                window.categories = window.newslist[0].name;
                getNewsData(window.categories);
                $('.menu_list a').eq(0).addClass('active');
                $(".menu_list").on("click","a",function(){
                    $(this).addClass('active').siblings().removeClass('active');
                    window.categories = $(this).attr("data-name");
                    //console.log(categories);
                    $("#homeNewsList").html('');
                    if(window.categories == "gifs"){
                        getGifData(window.categories);
                    }else{
                        getNewsData(window.categories);
                    }                    
                    
                });
            }
        });

        bindScroll();

	    $(".menu_btn").click(function(){
	        $(".menu").toggleClass("extend");
	        $(this).toggleClass("link-open");
	    });

	    $(".dload_clo").click(function(){
	    	$(".dot_dload").hide();
	    	$(".content_home").css("margin-top","97px");
	    });

	    $("#openApp").click(function(){
            ga('send', 'event', 'App', 'download', 'App Download');
    		openApp();
    	});	
	});

    function getGifData(category){
        $.ajax({
            url:url + "categories/"+ category +"/articles/random/",
            type:"get",
            dataType:"json",
            success:function(data){
                var data = data.data;
                var htmls = "";
                for(var i=0;i<data.length;i++){
                    htmls += parseGifHtml(data[i]);
                }
                $("#homeNewsList").html(htmls);
                $("img.lazy").lazyload();
            }
        })
    }
    
    function getNewsData(category){
        $.ajax({
            url:url + "categories/"+ category +"/articles/next/",
            type:"get",
            dataType:"json",
            success:function(data){
                var data = data.data;     
                var htmls = "";
                for(var i =0;i<data.length;i++){
                    htmls += parseHtml(data[i]);
                }               
                g_seq_id = data[data.length-1].seq_id;
                g_rec_time = data[data.length-1].rec_time;
                $("#homeNewsList").html(htmls);
                $("img.lazy").lazyload();
                $("#homeNewsList").on("click","ul",function(){
                    var aid = $(this).attr('data-id');
                    var type = $(this).attr('data-type');
                    if(type == "video"){
                        window.location.href = "video.html?aid=" + aid;
                    }else if(type == "images"){
                        window.location.href = "photos.html?aid=" + aid;
                    }else{
                        window.location.href = "details.html?aid=" + aid;
                    }                    
                });
            }
        });
    }
	function bindScroll(){
        $(window).scroll(function() {
            //$(document).scrollTop() 获取垂直滚动的距离
            //$(document).scrollLeft() 这是获取水平滚动条的距离
            /*if ($(document).scrollTop() <= 0) {
                console.log("滚动条已经到达顶部为0");
            }*/
            if ($(document).scrollTop() >= $(document).height() - $(window).height()) {
                //console.log("滚动条已经到达底部为" + $(document).scrollTop());
                if(window.categories == "gifs"){
                    $.ajax({
                        url:url + "categories/"+ window.categories +"/articles/random/",
                        type:"get",
                        dataType:"json",
                        success:function(data){
                            var data = data.data;
                            var htmls = "";
                            for(var i=0;i<data.length;i++){
                                htmls += parseGifHtml(data[i]);
                            }
                            $("#homeNewsList").append(htmls);
                            $("img.lazy").lazyload();
                        }
                    });
                }else{
                    $.ajax({
                        url:url + "categories/"+ window.categories +"/articles/prev/",
                        type:"get",
                        data:{"read_tag":g_seq_id,"last_rec_time":g_rec_time},
                        dataType:"json",
                        success:function(data){
                            var data = data.data;
                            if(data.length > 0){
                                var htmls = "";
                                g_seq_id = data[data.length-1].seq_id;
                                g_rec_time = data[data.length-1].rec_time;
                                for(var i =0;i<data.length;i++){
                                    htmls += parseHtml(data[i]);
                                }
                                $("#homeNewsList").append(htmls);
                            }                   
                            
                        }
                    });
                }                    
                
            }
            $("img.lazy").lazyload();
        });
    }

</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83720938-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
